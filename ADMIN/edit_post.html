<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit post</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
    <div class="wrapper">
        <div class="container">
            <div class="dashboard">
                <div class="left">
                    <span class="left__icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                    <div class="left__content">
                        <!-- <div class="left__logo">LOGO</div> -->
                        <div class="left__profile">
                            <div class="left__image"><img id="image-admin" src="" alt=""></div>
                            <p id="username-admin" class="left__name"></p>
                        </div>
                        <ul class="left__menu">
                            <li class="left__menuItem">
                                <a href="index.html" class="left__title"><img src="assets/icon-dashboard.svg"
                                        alt="">Home Page</a>
                            </li>
                            <li class="left__menuItem">
                                <div class="left__title"><img src="assets/icon-tag.svg" alt="">Blog & podcast<img
                                        class="left__iconDown" src="assets/arrow-down.svg" alt=""></div>
                                <div class="left__text">
                                    <a class="left__link" href="insert_post.html">Insert post</a>
                                    <a class="left__link" href="insert_podcast.html">Insert podcast</a>
                                    <a class="left__link" href="view_post.html">View post</a>
                                    <a class="left__link" href="view_podcast.html">View podcast</a>
                                </div>
                            </li>
                            <li class="left__menuItem">
                                <div class="left__title"><img src="assets/icon-edit.svg" alt="">Category Blog<img
                                        class="left__iconDown" src="assets/arrow-down.svg" alt=""></div>
                                <div class="left__text">
                                    <a class="left__link" href="insert_category.html">Insert category</a>
                                    <a class="left__link" href="view_category.html">View category</a>
                                </div>
                            </li>
                            <li class="left__menuItem">
                                <div class="left__title"><img src="assets/icon-edit.svg" alt="">Category PodCast<img
                                        class="left__iconDown" src="assets/arrow-down.svg" alt=""></div>
                                <div class="left__text">
                                    <a class="left__link" href="insert_category.html">Insert category</a>
                                    <a class="left__link" href="view_categorypostcast.html">View category</a>
                                </div>
                            </li>
                            <li class="left__menuItem">
                                <div class="left__title"><img src="assets/icon-book.svg" alt="">Course<img
                                        class="left__iconDown" src="assets/arrow-down.svg" alt=""></div>
                                <div class="left__text">
                                    <a class="left__link" href="insert_course.html">Insert course</a>
                                    <a class="left__link" href="view_course.html">View course</a>
                                </div>
                            </li>
                            <li class="left__menuItem">
                                <a href="view_customers.html" class="left__title"><img src="assets/icon-users.svg"
                                        alt="">User</a>
                            </li>
                            <li class="left__menuItem">
                                <div class="left__title"><img src="assets/icon-user.svg" alt="">Admin<img
                                        class="left__iconDown" src="assets/arrow-down.svg" alt=""></div>
                                <div class="left__text">
                                    <a class="left__link" href="insert_admin.html">Insert admin</a>
                                    <a class="left__link" href="view_admins.html">View admins</a>
                                </div>
                            </li>
                            <li class="left__menuItem">
                                <a   id="logoutadmin" class="left__title"><img src="assets/icon-logout.svg" alt="">Logout</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="right">
                    <div class="right__content">
                        <div class="right__title">Dashboard</div>
                        <p class="right__desc">Edit post</p>
                        <div class="right__formWrapper">
                            <form action="" method="PUT" enctype="multipart/form-data" id="updateform">
                                <div class="right__inputWrapper">
                                    <label for="title">Title</label>
                                    <input type="text" id="title" placeholder="Title">
                                </div>
                                <div class="right__inputWrapper">
                                    <label for="image">Image</label>
                                    <input type="file" id="fileblog" onclick="changefle()">
                                    <img style="width: 150px; height: 150px; margin: 10px 0 0 0" src="" id="imageblog"/>
                                </div>
                                <div class="right__inputWrapper">
                                    <label for="p_category">Category</label>
                                    <select name="" id="postcategory">
                                     
                                    </select>
                                </div>
                                <div class="right__inputWrapper">
                                    <label for="p_category">Rank</label>
                                    <select name="" id="rankblog">
                                        <option value="">Select rank</option>
                                        <option value="1">Gold</option>
                                        <option value="2">Diamond</option>
                                    </select>
                                </div>
                                <div class="right__inputWrapper">
                                    <label for="desc">Content</label>
                                    <textarea name="" id="descriptonblog" cols="30" rows="10" placeholder="Write something..."></textarea>
                                </div>
                                <button class="btn" type="submit">UPDATE</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/main.js"></script>
    <script src="API/index.js"></script>
    <!-- <script>
        const form = document.getElementById('updateform')
        var postApiBlog= "http://localhost:8000/post";
        var postApiPod= "http://localhost:8000/podcast";
            form.addEventListener('submit', function (e) {
            let input = (document.getElementById('fileimage').value).split("\\").pop();;
           
            let title = document.getElementById('title').value;
            let content = document.getElementById('content').value;
            let postcategory = document.getElementById('postcategory').value;
            let ranker = document.getElementById('ranker').value;
            var getUrl = window.location;
            var localhost = getUrl.protocol + "//" + getUrl.host + "/";
            let id = sessionStorage.getItem('idadmin');
            let name = sessionStorage.getItem('nameadmin');
            var datas =  {
                "id_user": id,
                "id_category": postcategory,
                "user": name,
                "title": title,
                "image": localhost+ "WebsitePodcast/IMG/" + input,
                "content": content,
                "numview": null,
                "numcomment": null,
                "numlove":null,
                "islove": null,
                "isgroup": null,
                "idgroup": null,
                "ranker": ranker
    };

            VALUE = JSON.stringify(datas);

  const myHeaders = new Headers();
  myHeaders.append('Content-Type', 'application/json');
  myHeaders.append('Access-Control-Allow-Methods','GET,PUT,POST,DELETE,PATCH,OPTIONS');
  myHeaders.append('Access-Control-Allow-Headers','Origin, X-Requested-With, Content-Type, Accept');
  myHeaders.append('Access-Control-Allow-Origin', '*');
  myHeaders.append('Access-Control-Allow-Credentials', 'true');
    fetch(postApiBlog, {
    method: 'POST',
    headers: myHeaders,
    mode: 'no-cors',
    body: VALUE
  })
    .then(data => {
      console.log(data);
    //   window.location.href = "view_admins.html";
    })
    .catch((err) => {
      console.error(err);
    });
});
</script> -->
<script>
     let idblog = sessionStorage.getItem('id-blog');
    console.log(idblog);
  const formpost = document.getElementById('updateform')
        var postApiBlog= "http://localhost:8000/post";
        formpost.addEventListener('submit', function (e) {
            let input = (document.getElementById('imageblog').getAttribute('src'));
            let title = document.getElementById('title').value;
            let content = document.getElementById('descriptonblog').value;
            let postcategory = document.getElementById('postcategory').value;
            let id = sessionStorage.getItem('idadmin');
            let name = sessionStorage.getItem('useradmin');
          
        });

   
    // get api ra podcast
    var urlpostdetails = 'http://localhost:8000/post';
    fetch(urlpostdetails + '/' + idblog)
      .then(response => response.json())
      .then(function (responses) {
        document.getElementById('rankblog').value = responses.ranker;
        document.querySelector('#postcategory').value = responses.id_category;
        document.getElementById('descriptonblog').value = responses.content;
        document.getElementById('title').value = responses.title;
        document.getElementById('imageblog').setAttribute('src', responses.image);
      })
      .catch((error) => {
        console.error('Error:', error);
      });
      
    //   function changefle(){
    //     let l = document.getElementById('fileblog').value;
    //       setTimeout(() => {
    //         alert(l);
    //       }, 600);
       
         
    //     //document.querySelector('#imageblog').setAttribute('src', );
    //   }
  


 
  var datas =  {
                "id_user": "96",
                    "id_category": "7",
                    "user": "đặng huyền",
                    "title": "AGILE  ",
                    "image": "http://localhost/WebsitePodcast/IMG/course.png",
                    "content": "Asking if agile working is necessary is like asking why the world gave birth to blockchain technology and the DeFi (decentralized finance) model. Simply because things focus it have its time, back ",
                    "numview": "0",
                    "numcomment": "0",
                    "numlove": "0",
                    "islove": "0",
                    "isgroup": "0",
                    "idgroup": "0",
                    "ranker": "1",
                    };
            VALUE = JSON.stringify(datas);
            var urlpostdetails = 'http://localhost:8000/post/1';
            fetch(urlpostdetails, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json', 
                'Access-Control-Allow-Methods':'GET,PUT,POST,DELETE,PATCH,OPTIONS',
                'Access-Control-Allow-Origin':'*',
                'Access-Control-Allow-Credentials':'true'
            },
            body: VALUE
        }).then(response => response.json()).then(data => {
            console.log(data);
                alert("đasad");
            })
            .catch((err) => {
            console.error(err);
            });
  
  </script>
</body>
</html>